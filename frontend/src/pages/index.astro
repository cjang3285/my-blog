---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import BlogCard from '../components/BlogCard.astro';
import ProjectCard from '../components/ProjectCard.astro';

// Fetch featured blog posts from backend
const API_URL = 'http://localhost:3000';
let featuredPosts = [];

try {
	const response = await fetch(`${API_URL}/api/posts/featured`);
	if (response.ok) {
		featuredPosts = await response.json();
	}
} catch (error) {
	console.error('Failed to fetch posts:', error);
}

// Featured projects data
const projects = [
	{
		title: 'Conferences Management',
		description: '컨퍼런스 정보를 관리하고 공유하는 시스템',
		link: '/conferences',
		tags: ['Express', 'REST API']
	},
	{
		title: 'Release Tracker',
		description: '소프트웨어 릴리즈 파일을 추적하고 다운로드할 수 있는 도구',
		link: '/releases',
		tags: ['Node.js', 'File Management']
	},
	{
		title: 'Status Monitor',
		description: '시스템 상태를 모니터링하고 표시하는 대시보드',
		link: '/status',
		tags: ['Monitoring', 'Dashboard']
	}
];
---

<Layout title="Home - My Blog" description="개발자의 학습과 성장을 기록하는 블로그">
	<Hero />

	<!-- Featured Blog Posts -->
	<section class="py-12">
		<div class="flex justify-between items-center mb-8">
			<h2 class="text-3xl font-bold">최신 글</h2>
			<a href="/blog" class="text-blue-600 dark:text-blue-400 hover:underline font-medium">
				전체 보기 →
			</a>
		</div>
		<div class="grid gap-6">
			{featuredPosts.length > 0 ? (
				featuredPosts.map(post => (
					<BlogCard
						title={post.title}
						excerpt={post.excerpt}
						date={post.date}
						slug={post.slug}
						tags={post.tags}
					/>
				))
			) : (
				<p class="text-gray-500 dark:text-gray-400 text-center py-12">
					블로그 글을 불러오는 중입니다... (백엔드 서버를 실행해주세요)
				</p>
			)}
		</div>
	</section>

	<!-- Featured Projects -->
	<section class="py-12">
		<div class="flex justify-between items-center mb-8">
			<h2 class="text-3xl font-bold">프로젝트</h2>
			<a href="/projects" class="text-blue-600 dark:text-blue-400 hover:underline font-medium">
				전체 보기 →
			</a>
		</div>
		<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
			{projects.map(project => (
				<ProjectCard
					title={project.title}
					description={project.description}
					link={project.link}
					tags={project.tags}
				/>
			))}
		</div>
	</section>

	<!-- About Section -->
	<section class="py-12">
		<div class="p-8 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/30 dark:to-indigo-950/30 border border-blue-200 dark:border-blue-800">
			<h2 class="text-2xl font-bold mb-4">About</h2>
			<p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-4">
				지속적으로 배우고 성장하는 개발자입니다. 프론트엔드부터 백엔드까지,
				풀스택 개발 역량을 키우며 실제로 동작하는 것을 만드는 데 집중합니다.
			</p>
			<p class="text-gray-700 dark:text-gray-300 leading-relaxed">
				이 블로그는 제가 배운 것들을 기록하고 공유하기 위한 공간입니다.
				Astro와 Express.js를 활용하여 직접 구축했습니다.
			</p>
		</div>
	</section>
</Layout>
